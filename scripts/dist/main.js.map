{"version":3,"sources":["main.js"],"names":["ready","fn","document","readyState","addEventListener","attachEvent","readyWrap","button","getElementsByClassName","feedbackContainer","inputs","getElementsByTagName","inspectionForm","logoNav","security","navigator","serviceWorker","register","then","registration","console","log","scope","catch","e","inputWidthController","target","base","chars","value","length","size","sendReport","AJAX","XMLHttpRequest","feedback","createElement","payload","FormData","URL","className","innerHTML","appendChild","onLine","status","ga","hitType","eventCategory","eventAction","eventLabel","querySelector","reset","open","send","formConnectionManager","setAttribute","hasChildNodes","removeChild","firstChild","removeAttribute","window","location","i","preventDefault"],"mappings":"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","file":"main.js","sourcesContent":["/* eslint-env browser */\n/* global ga */\n\nfunction ready(fn) {\n\tif (document.readyState !== 'loading') {\n\t\tfn()\n\t} else if (document.addEventListener) {\n\t\tdocument.addEventListener('DOMContentLoaded', fn)\n\t} else {\n\t\tdocument.attachEvent('onreadystatechange', () => {\n\t\t\tif (document.readyState !== 'loading') {\n\t\t\t\tfn()\n\t\t\t}\n\t\t})\n\t}\n}\n\nfunction readyWrap() {\n\tconst button = document.getElementsByClassName('form_submit')[0]\n\tconst feedbackContainer = document.getElementsByClassName('form_feedback')\n\tconst inputs = document.getElementsByTagName('input')\n\tconst inspectionForm = document.getElementsByClassName('inspection_form')\n\tconst logoNav = document.getElementsByClassName('logoNav')\n\tconst security = document.getElementsByClassName('form_security')\n\n\t// Register the ServiceWorker.\n\tif ('serviceWorker' in navigator) {\n\t\t// The service worker cannot access parent directories (apart from explicity setting scope), so keep it in the root directory.\n\t\tnavigator.serviceWorker\n\t\t\t.register('serviceWorker.js')\n\t\t\t.then((registration) => {\n\t\t\t\tconsole.log(`ServiceWorker registration successful with scope: ${registration.scope}`)\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tconsole.log(`ServiceWorker registration failed: ${e}`)\n\t\t\t})\n\t}\n\n\tfunction inputWidthController(target) {\n\t\tconst base = 25 // base size for all inputs\n\t\tconst chars = target.value.length\n\t\tconst size = target.size\n\t\tif (chars > size) {\n\t\t\t// if the input needs to expand\n\t\t\ttarget.size = target.value.length // expand it\n\t\t\treturn target.size\n\t\t} else if (chars < size && chars > base) {\n\t\t\t// if the input contains less than its width and still has more than 15 characters\n\t\t\ttarget.size = target.value.length // shrink it\n\t\t\treturn target.size\n\t\t} // otherwise\n\t\ttarget.size = base // set to the base width\n\t\treturn target.size\n\t}\n\n\tfunction sendReport() {\n\t\tconst AJAX = new XMLHttpRequest()\n\t\tconst feedback = document.createElement('p')\n\t\tconst payload = new FormData(inspectionForm[0])\n\t\tconst URL = 'https://message.integrisweb.com/sms/'\n\n\t\tif (security[0].value) {\n\t\t\t// if the security input has a value, it's been filled\n\t\t\tfeedback.className = 'feedback_error'\n\t\t\tfeedback.innerHTML =\n\t\t\t\t\"Sorry for the inconvenience, but you somehow triggered our anti-spam protection. Please use the contact information at the <a data-scroll href='#footer'>bottom of the page</a> to reach us.\"\n\t\t\tfeedbackContainer[0].appendChild(feedback)\n\t\t} else {\n\t\t\tif (navigator.onLine === false) {\n\t\t\t\tfeedback.className = 'feedback_warning'\n\t\t\t\tfeedback.innerHTML =\n\t\t\t\t\t\"Sorry for the inconvenience, but you are currently offline. You can't send a message while offline. You can wait until you are back online or use the contact information at the <a data-scroll href='#footer'>bottom of the page</a> to reach us.\"\n\t\t\t\tfeedbackContainer[0].appendChild(feedback)\n\t\t\t}\n\n\t\t\tAJAX.addEventListener('load', (e) => {\n\t\t\t\tif (e.target.status === 200) {\n\t\t\t\t\t// if the message was sent\n\t\t\t\t\tfeedback.className = 'feedback_success'\n\t\t\t\t\tfeedback.innerHTML = 'Your message was sent!'\n\t\t\t\t\tfeedbackContainer[0].appendChild(feedback)\n\n\t\t\t\t\tga('send', {\n\t\t\t\t\t\t// since GA is loaded in the head, assume its presence\n\t\t\t\t\t\thitType: 'event',\n\t\t\t\t\t\teventCategory: 'Form',\n\t\t\t\t\t\teventAction: 'send',\n\t\t\t\t\t\teventLabel: 'Contact Form'\n\t\t\t\t\t})\n\n\t\t\t\t\tdocument.querySelector('.inspection_form').reset() // empty the form on success\n\t\t\t\t} else {\n\t\t\t\t\t// something nonspecific has gone wrong\n\t\t\t\t\tfeedback.className = 'feedback_warning'\n\t\t\t\t\tfeedback.innerHTML =\n\t\t\t\t\t\t\"Sorry for the inconvenience, but your message may have not sent. You can try sending it again or use the contact information at the <a data-scroll href='#footer'>bottom of the page</a> to reach us.\"\n\t\t\t\t\tfeedbackContainer[0].appendChild(feedback)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tAJAX.open('POST', URL, true)\n\t\t\tAJAX.send(payload)\n\t\t}\n\t}\n\n\tfunction formConnectionManager() {\n\t\tif (navigator.onLine === false) {\n\t\t\tconst feedback = document.createElement('p')\n\n\t\t\tbutton.setAttribute('disabled', 'true')\n\t\t\tbutton.className = 'button form_submit disabled'\n\n\t\t\tfeedback.className = 'feedback_warning'\n\t\t\tfeedback.innerHTML =\n\t\t\t\t\"Sorry for the inconvenience, but you are currently offline. You can't send a message while offline. You can wait until you are back online or use the contact information at the <a data-scroll href='#footer'>bottom of the page</a> to reach us.\"\n\t\t\treturn feedbackContainer[0].appendChild(feedback)\n\t\t}\n\t\twhile (feedbackContainer[0].hasChildNodes()) {\n\t\t\tfeedbackContainer[0].removeChild(feedbackContainer[0].firstChild)\n\t\t}\n\n\t\tbutton.removeAttribute('disabled')\n\t\tbutton.className = 'button form_submit'\n\t\treturn button.className\n\t}\n\n\t/* event listeners & function calls */\n\tif (logoNav.length) {\n\t\tlogoNav[0].addEventListener('click', () => {\n\t\t\twindow.location = 'https://sewercam.net/'\n\t\t})\n\t}\n\n\tif (inputs.length) {\n\t\t// the only page with a form is 'your-sewer-scope.html'\n\t\tfor (let i = 0; i < inputs.length; i += 1) {\n\t\t\tinputs[i].addEventListener('input', (e) => {\n\t\t\t\tinputWidthController(e.target)\n\t\t\t})\n\t\t}\n\n\t\tinspectionForm[0].addEventListener('submit', (e) => {\n\t\t\te.preventDefault()\n\t\t\treturn sendReport()\n\t\t})\n\n\t\twindow.addEventListener('online', formConnectionManager)\n\n\t\twindow.addEventListener('offline', formConnectionManager)\n\t}\n}\n\nready(readyWrap)\n"]}